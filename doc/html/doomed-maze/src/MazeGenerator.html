<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><a name="line-3"></a><span>
</span><a name="line-4"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">MazeGenerator</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Monoid</span><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System.Random</span><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Debug.Trace</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><a href="Space.html"><span class="hs-identifier">Space</span></a><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-keyword">type</span><span> </span><a name="Maze"><a href="MazeGenerator.html#Maze"><span class="hs-identifier">Maze</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Space.html#Space"><span class="hs-identifier hs-type">Space</span></a><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-comment">-- | Utility function for debugging </span><span>
</span><a name="line-16"></a><span class="hs-identifier">prnt</span><span> </span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679035802"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679035802"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679035802"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-17"></a><a name="prnt"><a href="MazeGenerator.html#prnt"><span class="hs-identifier">prnt</span></a></a><span> </span><a name="local-6989586621679035803"><a href="#local-6989586621679035803"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">trace</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679035803"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679035803"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-comment">-- | Transpose maze</span><span>
</span><a name="line-20"></a><span class="hs-identifier">transposeMaze</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="MazeGenerator.html#Maze"><span class="hs-identifier hs-type">Maze</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MazeGenerator.html#Maze"><span class="hs-identifier hs-type">Maze</span></a><span>
</span><a name="line-21"></a><a name="transposeMaze"><a href="MazeGenerator.html#transposeMaze"><span class="hs-identifier">transposeMaze</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Space.html#transposeSpace"><span class="hs-identifier hs-var">transposeSpace</span></a><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-comment">-- | Generating random coords for vertical wall. </span><span>
</span><a name="line-24"></a><span class="hs-comment">-- X coordinate shows the position of wall, coordinate y - the position of hole in the wall</span><span>
</span><a name="line-25"></a><span class="hs-comment">-- In order to prevent changes gluing and keep maze connected, walls are created on odd </span><span>
</span><a name="line-26"></a><span class="hs-comment">-- positions, ways on even.</span><span>
</span><a name="line-27"></a><span class="hs-identifier">randomWallCoords</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">RandomGen</span><span> </span><a href="#local-6989586621679035801"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Space.html#Area"><span class="hs-identifier hs-type">Area</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679035801"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Space.html#Coords"><span class="hs-identifier hs-type">Coords</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679035801"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-28"></a><a name="randomWallCoords"><a href="MazeGenerator.html#randomWallCoords"><span class="hs-identifier">randomWallCoords</span></a></a><span> </span><span class="hs-special">(</span><a href="Space.html#Area"><span class="hs-identifier hs-var">Area</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679035804"><a href="#local-6989586621679035804"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679035805"><a href="#local-6989586621679035805"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679035806"><a href="#local-6989586621679035806"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679035807"><a href="#local-6989586621679035807"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679035808"><a href="#local-6989586621679035808"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679035809"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679035811"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679035812"><span class="hs-identifier hs-var">g''</span></a><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-30"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679035809"><a href="#local-6989586621679035809"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679035810"><a href="#local-6989586621679035810"><span class="hs-identifier">g'</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">randomR</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679035804"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679035806"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679035808"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-31"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679035811"><a href="#local-6989586621679035811"><span class="hs-identifier">j</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679035812"><a href="#local-6989586621679035812"><span class="hs-identifier">g''</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">randomR</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679035805"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679035807"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679035810"><span class="hs-identifier hs-var">g'</span></a><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-comment">-- | Create a Maze object for the wall, given coords, Area and object on the pass</span><span>
</span><a name="line-34"></a><span class="hs-identifier">createVerticalWall</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Space.html#Coords"><span class="hs-identifier hs-type">Coords</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Space.html#Area"><span class="hs-identifier hs-type">Area</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MazeGenerator.html#Maze"><span class="hs-identifier hs-type">Maze</span></a><span>
</span><a name="line-35"></a><a name="createVerticalWall"><a href="MazeGenerator.html#createVerticalWall"><span class="hs-identifier">createVerticalWall</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679035813"><a href="#local-6989586621679035813"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679035814"><a href="#local-6989586621679035814"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Space.html#Area"><span class="hs-identifier hs-var">Area</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679035815"><a href="#local-6989586621679035815"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679035816"><a href="#local-6989586621679035816"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679035817"><a href="#local-6989586621679035817"><span class="hs-identifier">obj</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Space.html#fromList"><span class="hs-identifier hs-var">fromList</span></a><span> </span><a href="#local-6989586621679035818"><span class="hs-identifier hs-var">coordsList</span></a><span>
</span><a name="line-36"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-37"></a><span>        </span><a name="local-6989586621679035818"><a href="#local-6989586621679035818"><span class="hs-identifier">coordsList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zip</span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679035813"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036011"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679036011"><a href="#local-6989586621679036011"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679035820"><span class="hs-identifier hs-var">range</span></a><span> </span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679035819"><span class="hs-identifier hs-var">ks</span></a><span>
</span><a name="line-38"></a><span>        </span><a name="local-6989586621679035819"><a href="#local-6989586621679035819"><span class="hs-identifier">ks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679035821"><span class="hs-identifier hs-var">getK</span></a><span> </span><a href="#local-6989586621679035820"><span class="hs-identifier hs-var">range</span></a><span>
</span><a name="line-39"></a><span>        </span><a name="local-6989586621679035820"><a href="#local-6989586621679035820"><span class="hs-identifier">range</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679035815"><span class="hs-identifier hs-var">b</span></a><span class="hs-glyph">..</span><a href="#local-6989586621679035816"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span>
</span><a name="line-40"></a><span>        </span><a name="local-6989586621679035821"><a href="#local-6989586621679035821"><span class="hs-identifier">getK</span></a></a><span> </span><a name="local-6989586621679036012"><a href="#local-6989586621679036012"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679036012"><span class="hs-identifier hs-var">y'</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679035814"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679035817"><span class="hs-identifier hs-var">obj</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-string">&quot;|&quot;</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-identifier">allDoors</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-44"></a><a name="allDoors"><a href="MazeGenerator.html#allDoors"><span class="hs-identifier">allDoors</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;a&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;b&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;c&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;d&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;e&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-identifier">head'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679035800"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679035800"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-47"></a><a name="head%27"><a href="MazeGenerator.html#head%27"><span class="hs-identifier">head'</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-48"></a><span class="hs-identifier">head'</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679036013"><a href="#local-6989586621679036013"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679036014"><a href="#local-6989586621679036014"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679036013"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-comment">-- | Function to generate button in random position.</span><span>
</span><a name="line-51"></a><span class="hs-identifier">generateButtonRandomly</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">RandomGen</span><span> </span><a href="#local-6989586621679035799"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679035799"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Space.html#Area"><span class="hs-identifier hs-type">Area</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="MazeGenerator.html#Maze"><span class="hs-identifier hs-type">Maze</span></a><span class="hs-special">,</span><a href="#local-6989586621679035799"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-52"></a><a name="generateButtonRandomly"><a href="MazeGenerator.html#generateButtonRandomly"><span class="hs-identifier">generateButtonRandomly</span></a></a><span> </span><a name="local-6989586621679036015"><a href="#local-6989586621679036015"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-special">(</span><a href="Space.html#Area"><span class="hs-identifier hs-var">Area</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679036016"><a href="#local-6989586621679036016"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679036017"><a href="#local-6989586621679036017"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679036018"><a href="#local-6989586621679036018"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679036019"><a href="#local-6989586621679036019"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679036020"><a href="#local-6989586621679036020"><span class="hs-identifier">obj</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036025"><span class="hs-identifier hs-var">maze</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036024"><span class="hs-identifier hs-var">g''</span></a><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-54"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679036021"><a href="#local-6989586621679036021"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679036022"><a href="#local-6989586621679036022"><span class="hs-identifier">g'</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">randomR</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036016"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><a href="#local-6989586621679036018"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679036015"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-55"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679036023"><a href="#local-6989586621679036023"><span class="hs-identifier">j</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679036024"><a href="#local-6989586621679036024"><span class="hs-identifier">g''</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">randomR</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036017"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679036019"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679036022"><span class="hs-identifier hs-var">g'</span></a><span>
</span><a name="line-56"></a><span>        </span><a name="local-6989586621679036025"><a href="#local-6989586621679036025"><span class="hs-identifier">maze</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Space.html#singleton"><span class="hs-identifier hs-var">singleton</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="#local-6989586621679036021"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="#local-6989586621679036023"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679036020"><span class="hs-identifier hs-var">obj</span></a><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-identifier">deleteObjFromList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-60"></a><a name="deleteObjFromList"><a href="MazeGenerator.html#deleteObjFromList"><span class="hs-identifier">deleteObjFromList</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-61"></a><span class="hs-identifier">deleteObjFromList</span><span> </span><a name="local-6989586621679036026"><a href="#local-6989586621679036026"><span class="hs-identifier">lst</span></a></a><span> </span><a name="local-6989586621679036027"><a href="#local-6989586621679036027"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">delete</span><span> </span><a href="#local-6989586621679036027"><span class="hs-identifier hs-var">str</span></a><span> </span><a href="#local-6989586621679036026"><span class="hs-identifier hs-var">lst</span></a><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span class="hs-comment">-- | Function that guarantees that exit is available.</span><span>
</span><a name="line-64"></a><span class="hs-identifier">clearExit</span><span class="hs-glyph">::</span><span> </span><a href="MazeGenerator.html#Maze"><span class="hs-identifier hs-type">Maze</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MazeGenerator.html#Maze"><span class="hs-identifier hs-type">Maze</span></a><span>
</span><a name="line-65"></a><a name="clearExit"><a href="MazeGenerator.html#clearExit"><span class="hs-identifier">clearExit</span></a></a><span> </span><a name="local-6989586621679036183"><a href="#local-6989586621679036183"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036191"><span class="hs-identifier hs-var">newMaze</span></a><span>
</span><a name="line-66"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-67"></a><span>        </span><a href="Space.html#Area"><span class="hs-identifier hs-var">Area</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679036184"><a href="#local-6989586621679036184"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679036185"><a href="#local-6989586621679036185"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679036186"><a href="#local-6989586621679036186"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679036187"><a href="#local-6989586621679036187"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="MazeGenerator.html#getAreaFromMaze"><span class="hs-identifier hs-var">getAreaFromMaze</span></a><span> </span><a href="#local-6989586621679036183"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-68"></a><span>        </span><a name="local-6989586621679036188"><a href="#local-6989586621679036188"><span class="hs-identifier">updatedSpaceObjects</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">delete</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679036186"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679036187"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-string">&quot;|&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="MazeGenerator.html#getObjsFromMaze"><span class="hs-identifier hs-var">getObjsFromMaze</span></a><span> </span><a href="#local-6989586621679036183"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span>        </span><a name="local-6989586621679036189"><a href="#local-6989586621679036189"><span class="hs-identifier">updatedSpaceObjects'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">delete</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679036186"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679036187"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-string">&quot;|&quot;</span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><a href="MazeGenerator.html#getObjsFromMaze"><span class="hs-identifier hs-var">getObjsFromMaze</span></a><span> </span><a href="#local-6989586621679036183"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span>        </span><a name="local-6989586621679036190"><a href="#local-6989586621679036190"><span class="hs-identifier">updatedSpaceObjects''</span></a></a><span> </span><span class="hs-glyph">=</span><span class="hs-identifier hs-var">delete</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679036186"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679036187"><span class="hs-identifier hs-var">b</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-string">&quot;|&quot;</span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><a href="MazeGenerator.html#getObjsFromMaze"><span class="hs-identifier hs-var">getObjsFromMaze</span></a><span> </span><a href="#local-6989586621679036183"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span>        </span><a name="local-6989586621679036191"><a href="#local-6989586621679036191"><span class="hs-identifier">newMaze</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Space.html#Space"><span class="hs-identifier hs-var">Space</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">spaceArea</span><span> </span><span class="hs-glyph">=</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Space.html#Area"><span class="hs-identifier hs-var">Area</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036184"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036185"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036186"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036187"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">spaceObjects</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036190"><span class="hs-identifier hs-var">updatedSpaceObjects''</span></a><span class="hs-special">}</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-comment">-- | Function to delete unneeded objects from Maze</span><span>
</span><a name="line-74"></a><span class="hs-identifier">filterEmpty</span><span class="hs-glyph">::</span><span> </span><a href="MazeGenerator.html#Maze"><span class="hs-identifier hs-type">Maze</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MazeGenerator.html#Maze"><span class="hs-identifier hs-type">Maze</span></a><span>
</span><a name="line-75"></a><a name="filterEmpty"><a href="MazeGenerator.html#filterEmpty"><span class="hs-identifier">filterEmpty</span></a></a><span> </span><a name="local-6989586621679036192"><a href="#local-6989586621679036192"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036195"><span class="hs-identifier hs-var">newMaze</span></a><span>
</span><a name="line-76"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-77"></a><span>        </span><a name="local-6989586621679036193"><a href="#local-6989586621679036193"><span class="hs-identifier">updatedSpaceObjects</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><a href="#local-6989586621679036194"><span class="hs-identifier hs-var">isEmpty</span></a><span> </span><span class="hs-special">(</span><a href="MazeGenerator.html#getObjsFromMaze"><span class="hs-identifier hs-var">getObjsFromMaze</span></a><span> </span><a href="#local-6989586621679036192"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-78"></a><span>        </span><a name="local-6989586621679036194"><a href="#local-6989586621679036194"><span class="hs-identifier">isEmpty</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679036196"><a href="#local-6989586621679036196"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679036197"><a href="#local-6989586621679036197"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679036197"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">==</span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-79"></a><span>        </span><a name="local-6989586621679036195"><a href="#local-6989586621679036195"><span class="hs-identifier">newMaze</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Space.html#Space"><span class="hs-identifier hs-var">Space</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">spaceArea</span><span> </span><span class="hs-glyph">=</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="MazeGenerator.html#getAreaFromMaze"><span class="hs-identifier hs-var">getAreaFromMaze</span></a><span> </span><a href="#local-6989586621679036192"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">spaceObjects</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036193"><span class="hs-identifier hs-var">updatedSpaceObjects</span></a><span class="hs-special">}</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-comment">-- | Function to recursively generate maze. Every time maze is divided into 2 and each part is generated recursively</span><span>
</span><a name="line-83"></a><span class="hs-identifier">genMaze</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">RandomGen</span><span> </span><a href="#local-6989586621679035798"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Space.html#Area"><span class="hs-identifier hs-type">Area</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679035798"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MazeGenerator.html#Maze"><span class="hs-identifier hs-type">Maze</span></a><span>
</span><a name="line-84"></a><a name="genMaze"><a href="MazeGenerator.html#genMaze"><span class="hs-identifier">genMaze</span></a></a><span> </span><a name="local-6989586621679036198"><a href="#local-6989586621679036198"><span class="hs-identifier">area</span></a></a><span> </span><a name="local-6989586621679036199"><a href="#local-6989586621679036199"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679036200"><a href="#local-6989586621679036200"><span class="hs-identifier">unOpened</span></a></a><span> </span><a name="local-6989586621679036201"><a href="#local-6989586621679036201"><span class="hs-identifier">opened</span></a></a><span>
</span><a name="line-85"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Space.html#thinArea"><span class="hs-identifier hs-var">thinArea</span></a><span> </span><a href="#local-6989586621679036198"><span class="hs-identifier hs-var">area</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036203"><span class="hs-identifier hs-var">newButton</span></a><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-var">mempty</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">spaceArea</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679036198"><span class="hs-identifier hs-var">area</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>     </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679036203"><span class="hs-identifier hs-var">newButton</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679036212"><span class="hs-identifier hs-var">wall</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679036217"><span class="hs-identifier hs-var">leftMaze</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679036218"><span class="hs-identifier hs-var">rightMaze</span></a><span>
</span><a name="line-87"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-88"></a><span>        </span><a name="local-6989586621679036202"><a href="#local-6989586621679036202"><span class="hs-identifier">button</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="MazeGenerator.html#head%27"><span class="hs-identifier hs-var">head'</span></a><span> </span><a href="#local-6989586621679036201"><span class="hs-identifier hs-var">opened</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">--</span><span>
</span><a name="line-89"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-90"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679036219"><a href="#local-6989586621679036219"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036219"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-91"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679036203"><a href="#local-6989586621679036203"><span class="hs-identifier">newButton</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679036204"><a href="#local-6989586621679036204"><span class="hs-identifier">g'o</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679036202"><span class="hs-identifier hs-var">button</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="Space.html#empty"><span class="hs-identifier hs-var">empty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036199"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="MazeGenerator.html#generateButtonRandomly"><span class="hs-identifier hs-var">generateButtonRandomly</span></a><span> </span><a href="#local-6989586621679036199"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679036198"><span class="hs-identifier hs-var">area</span></a><span> </span><a href="#local-6989586621679036202"><span class="hs-identifier hs-var">button</span></a><span>
</span><a name="line-92"></a><span>        </span><a name="local-6989586621679036205"><a href="#local-6989586621679036205"><span class="hs-identifier">newOpened</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MazeGenerator.html#deleteObjFromList"><span class="hs-identifier hs-var">deleteObjFromList</span></a><span> </span><a href="#local-6989586621679036201"><span class="hs-identifier hs-var">opened</span></a><span> </span><a href="#local-6989586621679036202"><span class="hs-identifier hs-var">button</span></a><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span>        </span><a name="local-6989586621679036206"><a href="#local-6989586621679036206"><span class="hs-identifier">door</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="MazeGenerator.html#head%27"><span class="hs-identifier hs-var">head'</span></a><span> </span><a href="#local-6989586621679036200"><span class="hs-identifier hs-var">unOpened</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">--  </span><span>
</span><a name="line-95"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-96"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679036220"><a href="#local-6989586621679036220"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036220"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-97"></a><span>        </span><a name="local-6989586621679036207"><a href="#local-6989586621679036207"><span class="hs-identifier">updatedOpened</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679036206"><span class="hs-identifier hs-var">door</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679036205"><span class="hs-identifier hs-var">newOpened</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679036205"><span class="hs-identifier hs-var">newOpened</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="MazeGenerator.html#toUpper"><span class="hs-identifier hs-var">toUpper</span></a><span> </span><a href="#local-6989586621679036206"><span class="hs-identifier hs-var">door</span></a><span class="hs-special">]</span><span>
</span><a name="line-98"></a><span>        </span><a name="local-6989586621679036208"><a href="#local-6989586621679036208"><span class="hs-identifier">newUs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MazeGenerator.html#deleteObjFromList"><span class="hs-identifier hs-var">deleteObjFromList</span></a><span> </span><a href="#local-6989586621679036200"><span class="hs-identifier hs-var">unOpened</span></a><span> </span><a href="#local-6989586621679036206"><span class="hs-identifier hs-var">door</span></a><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span>        </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679036209"><a href="#local-6989586621679036209"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679036210"><a href="#local-6989586621679036210"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679036211"><a href="#local-6989586621679036211"><span class="hs-identifier">g'</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="MazeGenerator.html#randomWallCoords"><span class="hs-identifier hs-var">randomWallCoords</span></a><span> </span><a href="#local-6989586621679036198"><span class="hs-identifier hs-var">area</span></a><span> </span><a href="#local-6989586621679036204"><span class="hs-identifier hs-var">g'o</span></a><span>
</span><a name="line-101"></a><span>        </span><a name="local-6989586621679036212"><a href="#local-6989586621679036212"><span class="hs-identifier">wall</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="MazeGenerator.html#createVerticalWall"><span class="hs-identifier hs-var">createVerticalWall</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036209"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="#local-6989586621679036210"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679036198"><span class="hs-identifier hs-var">area</span></a><span> </span><a href="#local-6989586621679036206"><span class="hs-identifier hs-var">door</span></a><span>
</span><a name="line-102"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679036213"><a href="#local-6989586621679036213"><span class="hs-identifier">left</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679036214"><a href="#local-6989586621679036214"><span class="hs-identifier">right</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Space.html#splitH"><span class="hs-identifier hs-var">splitH</span></a><span> </span><a href="#local-6989586621679036209"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679036198"><span class="hs-identifier hs-var">area</span></a><span>
</span><a name="line-103"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679036215"><a href="#local-6989586621679036215"><span class="hs-identifier">gl</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679036216"><a href="#local-6989586621679036216"><span class="hs-identifier">gr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">split</span><span> </span><a href="#local-6989586621679036211"><span class="hs-identifier hs-var">g'</span></a><span>
</span><a name="line-104"></a><span>        </span><a name="local-6989586621679036217"><a href="#local-6989586621679036217"><span class="hs-identifier">leftMaze</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="MazeGenerator.html#transposeMaze"><span class="hs-identifier hs-var">transposeMaze</span></a><span> </span><span class="hs-special">(</span><a href="MazeGenerator.html#genMaze"><span class="hs-identifier hs-var">genMaze</span></a><span> </span><span class="hs-special">(</span><a href="Space.html#transposeArea"><span class="hs-identifier hs-var">transposeArea</span></a><span> </span><a href="#local-6989586621679036213"><span class="hs-identifier hs-var">left</span></a><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679036215"><span class="hs-identifier hs-var">gl</span></a><span> </span><a href="#local-6989586621679036208"><span class="hs-identifier hs-var">newUs</span></a><span> </span><a href="#local-6989586621679036207"><span class="hs-identifier hs-var">updatedOpened</span></a><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>        </span><a name="local-6989586621679036218"><a href="#local-6989586621679036218"><span class="hs-identifier">rightMaze</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MazeGenerator.html#transposeMaze"><span class="hs-identifier hs-var">transposeMaze</span></a><span> </span><span class="hs-special">(</span><a href="MazeGenerator.html#genMaze"><span class="hs-identifier hs-var">genMaze</span></a><span> </span><span class="hs-special">(</span><a href="Space.html#transposeArea"><span class="hs-identifier hs-var">transposeArea</span></a><span> </span><a href="#local-6989586621679036214"><span class="hs-identifier hs-var">right</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679036216"><span class="hs-identifier hs-var">gr</span></a><span> </span><a href="#local-6989586621679036208"><span class="hs-identifier hs-var">newUs</span></a><span> </span><a href="#local-6989586621679036207"><span class="hs-identifier hs-var">updatedOpened</span></a><span class="hs-special">)</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">-- | Custom function to prevent &quot;Space&quot; naming conflicts </span><span>
</span><a name="line-108"></a><span class="hs-identifier">toUpper</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-109"></a><a name="toUpper"><a href="MazeGenerator.html#toUpper"><span class="hs-identifier">toUpper</span></a></a><span> </span><a name="local-6989586621679036221"><a href="#local-6989586621679036221"><span class="hs-identifier">s</span></a></a><span>
</span><a name="line-110"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679036221"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;a&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;A&quot;</span><span>
</span><a name="line-111"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679036221"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;b&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;B&quot;</span><span>
</span><a name="line-112"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679036221"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;c&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;C&quot;</span><span>
</span><a name="line-113"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679036221"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;d&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;D&quot;</span><span>
</span><a name="line-114"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679036221"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;e&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;E&quot;</span><span>
</span><a name="line-115"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679036221"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;A&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;A&quot;</span><span>
</span><a name="line-116"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679036221"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;B&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;B&quot;</span><span>
</span><a name="line-117"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679036221"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;C&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;C&quot;</span><span>
</span><a name="line-118"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679036221"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;D&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;D&quot;</span><span>
</span><a name="line-119"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679036221"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;E&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;E&quot;</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-comment">-- | Generation of exit coords. </span><span>
</span><a name="line-122"></a><span class="hs-identifier">exit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Space.html#Coords"><span class="hs-identifier hs-type">Coords</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MazeGenerator.html#Maze"><span class="hs-identifier hs-type">Maze</span></a><span>
</span><a name="line-123"></a><a name="exit"><a href="MazeGenerator.html#exit"><span class="hs-identifier">exit</span></a></a><span> </span><a name="local-6989586621679036222"><a href="#local-6989586621679036222"><span class="hs-identifier">cors</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Space.html#singleton"><span class="hs-identifier hs-var">singleton</span></a><span> </span><a href="#local-6989586621679036222"><span class="hs-identifier hs-var">cors</span></a><span> </span><span class="hs-string">&quot;$&quot;</span><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-comment">-- | Function to generate random coords in range</span><span>
</span><a name="line-126"></a><span class="hs-identifier">generateRandomCoords</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">RandomGen</span><span> </span><a href="#local-6989586621679035797"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679035797"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Space.html#Area"><span class="hs-identifier hs-type">Area</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Space.html#Coords"><span class="hs-identifier hs-type">Coords</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679035797"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-127"></a><a name="generateRandomCoords"><a href="MazeGenerator.html#generateRandomCoords"><span class="hs-identifier">generateRandomCoords</span></a></a><span> </span><a name="local-6989586621679036223"><a href="#local-6989586621679036223"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-special">(</span><a href="Space.html#Area"><span class="hs-identifier hs-var">Area</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679036224"><a href="#local-6989586621679036224"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679036225"><a href="#local-6989586621679036225"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679036226"><a href="#local-6989586621679036226"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679036227"><a href="#local-6989586621679036227"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679036228"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="#local-6989586621679036230"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036231"><span class="hs-identifier hs-var">g''</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-129"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679036228"><a href="#local-6989586621679036228"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679036229"><a href="#local-6989586621679036229"><span class="hs-identifier">g'</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">randomR</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036224"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><a href="#local-6989586621679036226"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679036223"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-130"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679036230"><a href="#local-6989586621679036230"><span class="hs-identifier">j</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679036231"><a href="#local-6989586621679036231"><span class="hs-identifier">g''</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">randomR</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036225"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679036227"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679036229"><span class="hs-identifier hs-var">g'</span></a><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-comment">-- | Function for recursive generation of batteries.</span><span>
</span><a name="line-133"></a><span class="hs-identifier">generateBatteriesList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">RandomGen</span><span> </span><a href="#local-6989586621679035796"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679035796"><span class="hs-identifier hs-type">g</span></a><span class="hs-glyph">-&gt;</span><span> </span><a href="MazeGenerator.html#Maze"><span class="hs-identifier hs-type">Maze</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Space.html#Coords"><span class="hs-identifier hs-type">Coords</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Space.html#Coords"><span class="hs-identifier hs-type">Coords</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-134"></a><a name="generateBatteriesList"><a href="MazeGenerator.html#generateBatteriesList"><span class="hs-identifier">generateBatteriesList</span></a></a><span> </span><a name="local-6989586621679036232"><a href="#local-6989586621679036232"><span class="hs-identifier">gen</span></a></a><span> </span><a name="local-6989586621679036233"><a href="#local-6989586621679036233"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679036234"><a href="#local-6989586621679036234"><span class="hs-identifier">res</span></a></a><span> </span><a name="local-6989586621679036235"><a href="#local-6989586621679036235"><span class="hs-identifier">lim</span></a></a><span>
</span><a name="line-135"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679036234"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679036235"><span class="hs-identifier hs-var">lim</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036234"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-136"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="MazeGenerator.html#isObject"><span class="hs-identifier hs-var">isObject</span></a><span> </span><a href="#local-6989586621679036236"><span class="hs-identifier hs-var">ranCoords</span></a><span> </span><a href="#local-6989586621679036233"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MazeGenerator.html#generateBatteriesList"><span class="hs-identifier hs-var">generateBatteriesList</span></a><span> </span><a href="#local-6989586621679036237"><span class="hs-identifier hs-var">gen'</span></a><span> </span><a href="#local-6989586621679036233"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679036234"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621679036235"><span class="hs-identifier hs-var">lim</span></a><span>
</span><a name="line-137"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="MazeGenerator.html#generateBatteriesList"><span class="hs-identifier hs-var">generateBatteriesList</span></a><span> </span><a href="#local-6989586621679036237"><span class="hs-identifier hs-var">gen'</span></a><span> </span><a href="#local-6989586621679036233"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679036236"><span class="hs-identifier hs-var">ranCoords</span></a><span class="hs-special">,</span><span class="hs-string">&quot;#&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679036234"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679036235"><span class="hs-identifier hs-var">lim</span></a><span>
</span><a name="line-138"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-139"></a><span>            </span><span class="hs-special">(</span><a name="local-6989586621679036236"><a href="#local-6989586621679036236"><span class="hs-identifier">ranCoords</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679036237"><a href="#local-6989586621679036237"><span class="hs-identifier">gen'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="MazeGenerator.html#generateRandomCoords"><span class="hs-identifier hs-var">generateRandomCoords</span></a><span> </span><a href="#local-6989586621679036232"><span class="hs-identifier hs-var">gen</span></a><span> </span><span class="hs-special">(</span><a href="MazeGenerator.html#getAreaFromMaze"><span class="hs-identifier hs-var">getAreaFromMaze</span></a><span> </span><a href="#local-6989586621679036233"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-comment">-- | Function to generate batteries for appending</span><span>
</span><a name="line-142"></a><span class="hs-identifier">addBatteries</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">RandomGen</span><span> </span><a href="#local-6989586621679035795"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679035795"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MazeGenerator.html#Maze"><span class="hs-identifier hs-type">Maze</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MazeGenerator.html#Maze"><span class="hs-identifier hs-type">Maze</span></a><span>
</span><a name="line-143"></a><a name="addBatteries"><a href="MazeGenerator.html#addBatteries"><span class="hs-identifier">addBatteries</span></a></a><span> </span><a name="local-6989586621679036238"><a href="#local-6989586621679036238"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679036239"><a href="#local-6989586621679036239"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679036240"><a href="#local-6989586621679036240"><span class="hs-identifier">lim</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036241"><span class="hs-identifier hs-var">updatedMaze</span></a><span>
</span><a name="line-144"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-145"></a><span>        </span><a name="local-6989586621679036241"><a href="#local-6989586621679036241"><span class="hs-identifier">updatedMaze</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Space.html#Space"><span class="hs-identifier hs-var">Space</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">spaceArea</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="MazeGenerator.html#getAreaFromMaze"><span class="hs-identifier hs-var">getAreaFromMaze</span></a><span> </span><a href="#local-6989586621679036239"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">spaceObjects</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036242"><span class="hs-identifier hs-var">oldMazeObjects</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679036243"><span class="hs-identifier hs-var">updatedSpaceObjects</span></a><span class="hs-special">}</span><span>
</span><a name="line-146"></a><span>        </span><a name="local-6989586621679036242"><a href="#local-6989586621679036242"><span class="hs-identifier">oldMazeObjects</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MazeGenerator.html#getObjsFromMaze"><span class="hs-identifier hs-var">getObjsFromMaze</span></a><span> </span><a href="#local-6989586621679036239"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-147"></a><span>        </span><a name="local-6989586621679036243"><a href="#local-6989586621679036243"><span class="hs-identifier">updatedSpaceObjects</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MazeGenerator.html#generateBatteriesList"><span class="hs-identifier hs-var">generateBatteriesList</span></a><span> </span><a href="#local-6989586621679036238"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679036239"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679036240"><span class="hs-identifier hs-var">lim</span></a><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-comment">-- | Generate level with given difficulty</span><span>
</span><a name="line-150"></a><span class="hs-identifier">generateDifficultLevel</span><span> </span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">RandomGen</span><span> </span><a href="#local-6989586621679035794"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679035794"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MazeGenerator.html#Maze"><span class="hs-identifier hs-type">Maze</span></a><span>
</span><a name="line-151"></a><a name="generateDifficultLevel"><a href="MazeGenerator.html#generateDifficultLevel"><span class="hs-identifier">generateDifficultLevel</span></a></a><span> </span><a name="local-6989586621679036244"><a href="#local-6989586621679036244"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679036245"><a href="#local-6989586621679036245"><span class="hs-identifier">dif</span></a></a><span>
</span><a name="line-152"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679036245"><span class="hs-identifier hs-var">dif</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036247"><span class="hs-identifier hs-var">mazeModification</span></a><span> </span><span class="hs-special">(</span><a href="MazeGenerator.html#genMaze"><span class="hs-identifier hs-var">genMaze</span></a><span> </span><span class="hs-special">(</span><a href="Space.html#Area"><span class="hs-identifier hs-var">Area</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-number">10</span><span class="hs-operator hs-var">+</span><a href="#local-6989586621679036245"><span class="hs-identifier hs-var">dif</span></a><span class="hs-special">,</span><span> </span><span class="hs-number">11</span><span class="hs-operator hs-var">+</span><a href="#local-6989586621679036245"><span class="hs-identifier hs-var">dif</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679036244"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036246"><span class="hs-identifier hs-var">doorsList</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-153"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679036245"><span class="hs-identifier hs-var">dif</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">5</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036247"><span class="hs-identifier hs-var">mazeModification</span></a><span class="hs-special">(</span><a href="MazeGenerator.html#genMaze"><span class="hs-identifier hs-var">genMaze</span></a><span> </span><span class="hs-special">(</span><a href="Space.html#Area"><span class="hs-identifier hs-var">Area</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-number">13</span><span class="hs-operator hs-var">+</span><a href="#local-6989586621679036245"><span class="hs-identifier hs-var">dif</span></a><span class="hs-special">,</span><span> </span><span class="hs-number">15</span><span class="hs-operator hs-var">+</span><a href="#local-6989586621679036245"><span class="hs-identifier hs-var">dif</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679036244"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036246"><span class="hs-identifier hs-var">doorsList</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-154"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679036245"><span class="hs-identifier hs-var">dif</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">7</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036247"><span class="hs-identifier hs-var">mazeModification</span></a><span class="hs-special">(</span><a href="MazeGenerator.html#genMaze"><span class="hs-identifier hs-var">genMaze</span></a><span> </span><span class="hs-special">(</span><a href="Space.html#Area"><span class="hs-identifier hs-var">Area</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-number">15</span><span class="hs-operator hs-var">+</span><a href="#local-6989586621679036245"><span class="hs-identifier hs-var">dif</span></a><span class="hs-special">,</span><span> </span><span class="hs-number">21</span><span class="hs-operator hs-var">+</span><a href="#local-6989586621679036245"><span class="hs-identifier hs-var">dif</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679036244"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036246"><span class="hs-identifier hs-var">doorsList</span></a><span> </span><span class="hs-number">3</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-155"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679036245"><span class="hs-identifier hs-var">dif</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036247"><span class="hs-identifier hs-var">mazeModification</span></a><span> </span><span class="hs-special">(</span><a href="MazeGenerator.html#genMaze"><span class="hs-identifier hs-var">genMaze</span></a><span> </span><span class="hs-special">(</span><a href="Space.html#Area"><span class="hs-identifier hs-var">Area</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-number">20</span><span class="hs-operator hs-var">+</span><a href="#local-6989586621679036245"><span class="hs-identifier hs-var">dif</span></a><span class="hs-special">,</span><span> </span><span class="hs-number">25</span><span class="hs-operator hs-var">+</span><a href="#local-6989586621679036245"><span class="hs-identifier hs-var">dif</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679036244"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036246"><span class="hs-identifier hs-var">doorsList</span></a><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-number">3</span><span>
</span><a name="line-156"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036247"><span class="hs-identifier hs-var">mazeModification</span></a><span> </span><span class="hs-special">(</span><a href="MazeGenerator.html#genMaze"><span class="hs-identifier hs-var">genMaze</span></a><span> </span><span class="hs-special">(</span><a href="Space.html#Area"><span class="hs-identifier hs-var">Area</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-number">10</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679036245"><span class="hs-identifier hs-var">dif</span></a><span> </span><span class="hs-operator hs-var">*</span><span class="hs-number">2</span><span class="hs-special">,</span><span> </span><span class="hs-number">15</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679036245"><span class="hs-identifier hs-var">dif</span></a><span class="hs-operator hs-var">*</span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679036244"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036246"><span class="hs-identifier hs-var">doorsList</span></a><span> </span><span class="hs-number">5</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036245"><span class="hs-identifier hs-var">dif</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-158"></a><span>            </span><a name="local-6989586621679036246"><a href="#local-6989586621679036246"><span class="hs-identifier">doorsList</span></a></a><span> </span><a name="local-6989586621679036249"><a href="#local-6989586621679036249"><span class="hs-identifier">num</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">take</span><span> </span><a href="#local-6989586621679036249"><span class="hs-identifier hs-var">num</span></a><span> </span><a href="MazeGenerator.html#allDoors"><span class="hs-identifier hs-var">allDoors</span></a><span>
</span><a name="line-159"></a><span>            </span><a name="local-6989586621679036247"><a href="#local-6989586621679036247"><span class="hs-identifier">mazeModification</span></a></a><span> </span><a name="local-6989586621679036250"><a href="#local-6989586621679036250"><span class="hs-identifier">maze</span></a></a><span> </span><a name="local-6989586621679036251"><a href="#local-6989586621679036251"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MazeGenerator.html#addBatteries"><span class="hs-identifier hs-var">addBatteries</span></a><span> </span><a href="#local-6989586621679036244"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="MazeGenerator.html#clearExit"><span class="hs-identifier hs-var">clearExit</span></a><span> </span><span class="hs-special">(</span><a href="MazeGenerator.html#filterEmpty"><span class="hs-identifier hs-var">filterEmpty</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036250"><span class="hs-identifier hs-var">maze</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679036248"><span class="hs-identifier hs-var">appendExit</span></a><span> </span><a href="#local-6989586621679036250"><span class="hs-identifier hs-var">maze</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679036251"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-160"></a><span>            </span><a name="local-6989586621679036248"><a href="#local-6989586621679036248"><span class="hs-identifier">appendExit</span></a></a><span> </span><a name="local-6989586621679036252"><a href="#local-6989586621679036252"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MazeGenerator.html#exit"><span class="hs-identifier hs-var">exit</span></a><span> </span><span class="hs-special">(</span><a href="MazeGenerator.html#getMazeSize"><span class="hs-identifier hs-var">getMazeSize</span></a><span> </span><a href="#local-6989586621679036252"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-comment">-- | Function to convert maze to array</span><span>
</span><a name="line-163"></a><span class="hs-identifier">mazeToGrid</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MazeGenerator.html#Maze"><span class="hs-identifier hs-type">Maze</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-164"></a><a name="mazeToGrid"><a href="MazeGenerator.html#mazeToGrid"><span class="hs-identifier">mazeToGrid</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679036253"><a href="#local-6989586621679036253"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036253"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-165"></a><span class="hs-identifier">mazeToGrid</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679036254"><a href="#local-6989586621679036254"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679036255"><a href="#local-6989586621679036255"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679036256"><a href="#local-6989586621679036256"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679036257"><a href="#local-6989586621679036257"><span class="hs-identifier">res</span></a></a><span>
</span><a name="line-166"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679036259"><span class="hs-identifier hs-var">isNotFloor</span></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="MazeGenerator.html#mazeToGrid"><span class="hs-identifier hs-var">mazeToGrid</span></a><span> </span><a href="#local-6989586621679036255"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679036256"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036257"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679036258"><span class="hs-identifier hs-var">object</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-167"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span>  </span><a href="MazeGenerator.html#mazeToGrid"><span class="hs-identifier hs-var">mazeToGrid</span></a><span> </span><a href="#local-6989586621679036255"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679036256"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036257"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-string">&quot;.&quot;</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-168"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-169"></a><span>            </span><a name="local-6989586621679036258"><a href="#local-6989586621679036258"><span class="hs-identifier">object</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MazeGenerator.html#getObjectFromCoords"><span class="hs-identifier hs-var">getObjectFromCoords</span></a><span> </span><a href="#local-6989586621679036254"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679036260"><span class="hs-identifier hs-var">spaceObjects</span></a><span>
</span><a name="line-170"></a><span>            </span><a name="local-6989586621679036259"><a href="#local-6989586621679036259"><span class="hs-identifier">isNotFloor</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MazeGenerator.html#isObject"><span class="hs-identifier hs-var">isObject</span></a><span> </span><a href="#local-6989586621679036254"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679036256"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-171"></a><span>            </span><a href="Space.html#Space"><span class="hs-identifier hs-var">Space</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036256"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-comment">-- | Getter of object given coords. </span><span>
</span><a name="line-174"></a><span class="hs-identifier">getObjectFromCoords</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Space.html#Coords"><span class="hs-identifier hs-type">Coords</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-175"></a><a name="getObjectFromCoords"><a href="MazeGenerator.html#getObjectFromCoords"><span class="hs-identifier">getObjectFromCoords</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-176"></a><span class="hs-identifier">getObjectFromCoords</span><span> </span><a name="local-6989586621679036262"><a href="#local-6989586621679036262"><span class="hs-identifier">coords</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679036263"><a href="#local-6989586621679036263"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679036264"><a href="#local-6989586621679036264"><span class="hs-identifier">o</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679036265"><a href="#local-6989586621679036265"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-177"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679036262"><span class="hs-identifier hs-var">coords</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679036263"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036264"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-178"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="MazeGenerator.html#getObjectFromCoords"><span class="hs-identifier hs-var">getObjectFromCoords</span></a><span> </span><a href="#local-6989586621679036262"><span class="hs-identifier hs-var">coords</span></a><span> </span><a href="#local-6989586621679036265"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span class="hs-comment">-- | Getter of area given maze.</span><span>
</span><a name="line-181"></a><span class="hs-identifier">getAreaFromMaze</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="MazeGenerator.html#Maze"><span class="hs-identifier hs-type">Maze</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Space.html#Area"><span class="hs-identifier hs-type">Area</span></a><span>
</span><a name="line-182"></a><a name="getAreaFromMaze"><a href="MazeGenerator.html#getAreaFromMaze"><span class="hs-identifier">getAreaFromMaze</span></a></a><span> </span><a href="Space.html#Space"><span class="hs-identifier hs-var">Space</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679036267"><span class="hs-identifier hs-var">spaceArea</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-183"></a><span>                                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679036268"><a href="#local-6989586621679036268"><span class="hs-identifier">value</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036268"><span class="hs-identifier hs-var">value</span></a><span>
</span><a name="line-184"></a><span>                                </span><span class="hs-identifier hs-var">Nothing</span><span>    </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="Space.html#Area"><span class="hs-identifier hs-var">Area</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-comment">-- | Get maze size</span><span>
</span><a name="line-187"></a><span class="hs-identifier">getMazeSize</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="MazeGenerator.html#Maze"><span class="hs-identifier hs-type">Maze</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Space.html#Coords"><span class="hs-identifier hs-type">Coords</span></a><span>
</span><a name="line-188"></a><a name="getMazeSize"><a href="MazeGenerator.html#getMazeSize"><span class="hs-identifier">getMazeSize</span></a></a><span> </span><a name="local-6989586621679036269"><a href="#local-6989586621679036269"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036271"><span class="hs-identifier hs-var">getSecondCoords</span></a><span> </span><a href="#local-6989586621679036270"><span class="hs-identifier hs-var">area</span></a><span>
</span><a name="line-189"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-190"></a><span>        </span><a name="local-6989586621679036270"><a href="#local-6989586621679036270"><span class="hs-identifier">area</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MazeGenerator.html#getAreaFromMaze"><span class="hs-identifier hs-var">getAreaFromMaze</span></a><span> </span><a href="#local-6989586621679036269"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-191"></a><span>        </span><a name="local-6989586621679036271"><a href="#local-6989586621679036271"><span class="hs-identifier">getSecondCoords</span></a></a><span> </span><span class="hs-special">(</span><a href="Space.html#Area"><span class="hs-identifier hs-var">Area</span></a><span> </span><a name="local-6989586621679036272"><a href="#local-6989586621679036272"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679036273"><a href="#local-6989586621679036273"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036273"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span class="hs-comment">-- | Getter of objects from maze.</span><span>
</span><a name="line-194"></a><span class="hs-identifier">getObjsFromMaze</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="MazeGenerator.html#Maze"><span class="hs-identifier hs-type">Maze</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Space.html#Coords"><span class="hs-identifier hs-type">Coords</span></a><span class="hs-special">,</span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-195"></a><a name="getObjsFromMaze"><a href="MazeGenerator.html#getObjsFromMaze"><span class="hs-identifier">getObjsFromMaze</span></a></a><span> </span><a href="Space.html#Space"><span class="hs-identifier hs-var">Space</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036274"><span class="hs-identifier hs-var">spaceObjects</span></a><span>
</span><a name="line-196"></a><span>
</span><a name="line-197"></a><span class="hs-comment">-- | Check if there is an object on the coords.  </span><span>
</span><a name="line-198"></a><span class="hs-identifier">isObject</span><span class="hs-glyph">::</span><span> </span><a href="Space.html#Coords"><span class="hs-identifier hs-type">Coords</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MazeGenerator.html#Maze"><span class="hs-identifier hs-type">Maze</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-199"></a><a name="isObject"><a href="MazeGenerator.html#isObject"><span class="hs-identifier">isObject</span></a></a><span> </span><a name="local-6989586621679036276"><a href="#local-6989586621679036276"><span class="hs-identifier">coords</span></a></a><span> </span><a href="Space.html#Space"><span class="hs-identifier hs-var">Space</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679036279"><a href="#local-6989586621679036279"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679036279"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679036276"><span class="hs-identifier hs-var">coords</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679036277"><span class="hs-identifier hs-var">spaceObjects</span></a><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span>
</span><a name="line-202"></a><span class="hs-comment">-- | Function to split array into subarrays every n els. </span><span>
</span><a name="line-203"></a><span class="hs-identifier">splitEvery</span><span> </span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679035793"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679035793"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-204"></a><a name="splitEvery"><a href="MazeGenerator.html#splitEvery"><span class="hs-identifier">splitEvery</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-205"></a><span class="hs-identifier">splitEvery</span><span> </span><a name="local-6989586621679036280"><a href="#local-6989586621679036280"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679036281"><a href="#local-6989586621679036281"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036282"><span class="hs-identifier hs-var">first</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">(</span><a href="MazeGenerator.html#splitEvery"><span class="hs-identifier hs-var">splitEvery</span></a><span> </span><a href="#local-6989586621679036280"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679036283"><span class="hs-identifier hs-var">rest</span></a><span class="hs-special">)</span><span>
</span><a name="line-206"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-207"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679036282"><a href="#local-6989586621679036282"><span class="hs-identifier">first</span></a></a><span class="hs-special">,</span><a name="local-6989586621679036283"><a href="#local-6989586621679036283"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">splitAt</span><span> </span><a href="#local-6989586621679036280"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679036281"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-comment">-- | Function for transforming Array of Strings to a single string</span><span>
</span><a name="line-210"></a><span class="hs-identifier">joinString</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-211"></a><a name="joinString"><a href="MazeGenerator.html#joinString"><span class="hs-identifier">joinString</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-212"></a><span class="hs-identifier">joinString</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679036284"><a href="#local-6989586621679036284"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679036285"><a href="#local-6989586621679036285"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036284"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">!!</span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="MazeGenerator.html#joinString"><span class="hs-identifier hs-var">joinString</span></a><span> </span><a href="#local-6989586621679036285"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-213"></a><span>
</span><a name="line-214"></a><span class="hs-comment">-- | Funtion to add borders to string representation of Maze</span><span>
</span><a name="line-215"></a><span class="hs-identifier">addBorders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-216"></a><a name="addBorders"><a href="MazeGenerator.html#addBorders"><span class="hs-identifier">addBorders</span></a></a><span> </span><a name="local-6989586621679036286"><a href="#local-6989586621679036286"><span class="hs-identifier">curMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679036289"><span class="hs-identifier hs-var">verticalBorder</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036288"><span class="hs-identifier hs-var">lowerHorizontalBorder</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679036286"><span class="hs-identifier hs-var">curMap</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679036287"><span class="hs-identifier hs-var">upperHorizontalBorder</span></a><span class="hs-special">)</span><span>
</span><a name="line-217"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-218"></a><span>    </span><a name="local-6989586621679036287"><a href="#local-6989586621679036287"><span class="hs-identifier">upperHorizontalBorder</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">replicate</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036290"><span class="hs-identifier hs-var">width</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;|&quot;</span><span class="hs-special">)</span><span class="hs-operator hs-var">++</span><span class="hs-special">[</span><span class="hs-string">&quot;$&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-219"></a><span>    </span><a name="local-6989586621679036288"><a href="#local-6989586621679036288"><span class="hs-identifier">lowerHorizontalBorder</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-string">&quot;%&quot;</span><span class="hs-special">]</span><span class="hs-operator hs-var">++</span><span class="hs-special">(</span><span class="hs-identifier hs-var">replicate</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036290"><span class="hs-identifier hs-var">width</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;|&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-220"></a><span>    </span><a name="local-6989586621679036289"><a href="#local-6989586621679036289"><span class="hs-identifier">verticalBorder</span></a></a><span> </span><a name="local-6989586621679036291"><a href="#local-6989586621679036291"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-string">&quot;|&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679036291"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;|&quot;</span><span>
</span><a name="line-221"></a><span>    </span><a name="local-6989586621679036290"><a href="#local-6989586621679036290"><span class="hs-identifier">width</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679036286"><span class="hs-identifier hs-var">curMap</span></a><span class="hs-special">)</span><span>
</span><a name="line-222"></a></pre></body></html>